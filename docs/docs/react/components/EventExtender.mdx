import { useState } from 'react';
import { EventExtender } from '@modern-kit/react';
import { delay } from '@modern-kit/utils';

# EventExtender

ìì‹ ì»´í¬ë„ŒíŠ¸ì˜ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ í™•ì¥í•˜ì—¬ `ì „í›„ ì²˜ë¦¬`ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤.

ê¸°ë³¸ì ìœ¼ë¡œ `isAsync` ì˜µì…˜ì€ `false`ì´ë©°, `ë™ê¸° ì´ë²¤íŠ¸`ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.

`isAsync` ì˜µì…˜ì„ `true`ë¡œ ì£¼ê³ , `ë¹„ë™ê¸° ì´ë²¤íŠ¸` ë¥¼ ì²˜ë¦¬ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ `ë¹„ë™ê¸° ì´ë²¤íŠ¸ ìˆœì„œ ë³´ì¥`ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë‹¨, `ë¹„ë™ê¸° ì´ë²¤íŠ¸`ë¥¼ ì²˜ë¦¬ í•  ê²½ìš° ì¼ë°˜ì ì¸ ì´ë²¤íŠ¸ í˜¸ì¶œ ìˆœì„œê°€ ì•„ë‹Œ ìˆœì„œë¡œ ì´ë²¤íŠ¸ê°€ í˜¸ì¶œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ëŸ° í˜„ìƒì€ ëŒ€í‘œì ìœ¼ë¡œ `MouseEvent`ë¥¼ ìº¡ì²˜í•˜ëŠ” ê²½ìš°ì— ë°œìƒí•©ë‹ˆë‹¤.
- ì˜ˆë¥¼ ë“¤ì–´, `onMouseUp` ì´ë²¤íŠ¸ëŠ” `onClick` ì´ë²¤íŠ¸ ì´ì „ì— í˜¸ì¶œë˜ëŠ”ê²Œ ì¼ë°˜ì ì´ì§€ë§Œ, í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ë¡œ `onMouseUp` ì´ë²¤íŠ¸ë¥¼ ìº¡ì²˜í•˜ë©´ `onMouseUp` ì´ë²¤íŠ¸ê°€ `onClick` ì´ë²¤íŠ¸ ì´í›„ì— í˜¸ì¶œë©ë‹ˆë‹¤.
- ì´ëŸ¬í•œ í˜„ìƒì€ `isAsync`ê°€ `true`ì¼ ì‹œ ì´ë²¤íŠ¸ë¥¼ `await` í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

<br />

## Code
[ğŸ”— ì‹¤ì œ êµ¬í˜„ ì½”ë“œ í™•ì¸](https://github.com/modern-agile-team/modern-kit/blob/main/packages/react/src/components/EventExtender/index.tsx)

## Interface
```ts title="typescript"
/**
 * @description HTML ìš”ì†Œë“¤ì˜ íƒœê·¸ ì´ë¦„ íƒ€ì… (ì˜ˆ: "div", "span", "input" ë“±)
 */
type HTMLElementType = keyof JSX.IntrinsicElements;

/**
 * @description React.DOMAttributes<HTMLElement>ì— ì •ì˜ëœ ì´ë²¤íŠ¸
 * - "on"ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì´ë¦„ë§Œ í¬í•¨ (ì˜ˆ: "onClick", "onChange", "onSubmit" ë“±)
 */
type EventNames = keyof React.DOMAttributes<HTMLElement> & `on${string}`;

/**
 * @description íŠ¹ì • HTML ìš”ì†Œì˜ íŠ¹ì • ì´ë²¤íŠ¸ì— ëŒ€í•œ ì´ë²¤íŠ¸ ê°ì²´ íƒ€ì…ì„ ì¶”ë¡ í•˜ëŠ” ì œë„¤ë¦­ íƒ€ì…
 * @template K - HTML ìš”ì†Œ íƒ€ì… (ì˜ˆ: "button", "input" ë“±)
 * @template E - ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì´ë¦„ (ì˜ˆ: "onClick", "onChange" ë“±)
 * @returns í•´ë‹¹ ì´ë²¤íŠ¸ì˜ ì´ë²¤íŠ¸ ê°ì²´ íƒ€ì… ë˜ëŠ” never
 */
type ElementEventType<
  K extends HTMLElementType,
  E extends EventNames
> = JSX.IntrinsicElements[K][E] extends ((e: infer Event) => void) | undefined
  ? Event
  : never;
```
```tsx title="typescript"
interface EventExtenderProps<K extends HTMLElementType, E extends EventNames> {
  children: JSX.Element;
  capture: E;
  isAsync?: boolean; // ê¸°ë³¸ê°’: false
  beforeEvent?: (e: ElementEventType<K, E>) => void | Promise<void>;
  afterEvent?: (e: ElementEventType<K, E>) => void | Promise<void>;
}

const EventExtender: <
  K extends keyof JSX.IntrinsicElements,
  E extends EventNames
>({
  children,
  capture,
  isAsync,
  beforeEvent,
  afterEvent,
}: EventExtenderProps<K, E>) => JSX.Element;
```

## Usage
### ê¸°ë³¸ ì‚¬ìš©ë²•
```tsx title="typescript"
import { EventExtender } from '@modern-kit/react'

const Example = () => {
  return (
    <EventExtender
      capture="onClick"
      beforeEvent={(e: React.MouseEvent<HTMLButtonElement>) => {
        console.log('í´ë¦­ ì „', e);
      }}
      afterEvent={(e: React.MouseEvent<HTMLButtonElement>) => {
        console.log('í´ë¦­ í›„', e);
      }}>
      <button onClick={(e) => console.log('í´ë¦­', e)}>Sync Button</button>
    </EventExtender>
  );
};
```

export const SyncExample = () => {
  return (
    <>
      <p>ê°œë°œì ë„êµ¬ ì½˜ì†”ì—ì„œ í™•ì¸í•´ì£¼ì„¸ìš”.</p>
      <EventExtender
        capture="onClick"
        beforeEvent={(e) => {
          console.log('í´ë¦­ ì „', e);
        }}
        afterEvent={(e) => {
          console.log('í´ë¦­ í›„', e);
        }}>
        <button onClick={(e) => console.log('í´ë¦­', e)}>Sync Button</button>
      </EventExtender>
    </>
  );
};

<SyncExample />

<br />

### ë¹„ë™ê¸° ì´ë²¤íŠ¸ ì²˜ë¦¬
```tsx title="typescript"
import { EventExtender } from '@modern-kit/react'

const Example = () => {
  return (
    <EventExtender
      isAsync={true} // (*)
      capture="onClick"
      beforeEvent={async (e: React.MouseEvent<HTMLButtonElement>) => {
        await delay(500);
        console.log('í´ë¦­ ì „', e);
      }}
      afterEvent={async (e: React.MouseEvent<HTMLButtonElement>) => {
        await delay(500);
        console.log('í´ë¦­ í›„', e);
      }}>
      <button
        onClick={async (e: React.MouseEvent<HTMLButtonElement>) => {
          await delay(500);
          console.log('í´ë¦­', e);
        }}>
        Async Button
      </button>
    </EventExtender>
  );
};
```

export const AsyncExample = () => {
  return (
    <>
      <p>ê°œë°œì ë„êµ¬ ì½˜ì†”ì—ì„œ í™•ì¸í•´ì£¼ì„¸ìš”.</p>
      <EventExtender
        isAsync
        capture="onClick"
        beforeEvent={async (e) => {
          await delay(500);
          console.log('í´ë¦­ ì „', e);
        }}
        afterEvent={async (e) => {
          await delay(500);
          console.log('í´ë¦­ í›„', e);
        }}>
        <button
          onClick={async (e) => {
            await delay(500);
            console.log('í´ë¦­', e);
          }}>
          Async Button
        </button>
      </EventExtender>
    </>
  );
};

<AsyncExample />

