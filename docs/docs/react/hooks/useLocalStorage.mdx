import { useLocalStorage } from '@modern-kit/react';

# useLocalStorage

`React v18`ë¶€í„° ì§€ì›í•˜ëŠ” **[useSyncExternalStore](https://react.dev/reference/react/useSyncExternalStore)** ì„ í™œìš©í•´ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ë‚´ì˜ íŠ¹ì • `key` ë°ì´í„°ë¥¼ êµ¬ë…í•˜ê³ , êµ¬ë… ì¤‘ì¸ ë°ì´í„°ì— ë³€í™”ê°€ ìˆì„ ì‹œ ì´ë¥¼ ë™ê¸°í™”í•´ì£¼ëŠ” ì»¤ìŠ¤í…€ í›…ì…ë‹ˆë‹¤.

ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— êµ¬ë…í•˜ê³ ì í•˜ëŠ” `key`ê°€ ì—†ì„ ê²½ìš° ë°˜í™˜í•  `initialValue`ë¡œ ì´ˆê¸°ê°’ì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ, `ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§(SSR)`ì˜ ê²½ìš° ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ê°€ ë™ì‘í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— `initialValue`ê°€ ë°˜í™˜ë©ë‹ˆë‹¤.

`setState`ëŠ” ê°’ ìì²´ë¥¼ ë„˜ê¸¸ ìˆ˜ ìˆìœ¼ë©°, í•¨ìˆ˜ë„ ë„˜ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•¨ìˆ˜ë¡œ í™œìš© ì‹œì— ì¸ìë¡œ stateë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```ts
const { state, setState, removeState } = useLocalStorage<number[]>({
  key: 'test',
  initialValue: [1, 2],
});

setState([1, 2, 3]);
setState(state => [...state, 3]);
```

<br />

initialValueë¥¼ ë„˜ê²¨ì£¼ë©´ ë”ìš± `ëª…í™•í•œ íƒ€ì… ì¶”ë¡ `ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```ts
const { state, setState } = useLocalStorage<number[]>({
  key: 'test',
});

state; // number[] | null
setState(state => {
  state; // number[] | null
});
```

```ts
const { state, setState } = useLocalStorage<number[]>({
  key: 'test',
  initialValue: [],
});

state; // number[]
setState(state => {
  state; // number[]
});
```

`visibilityChange` ì˜µì…˜ì„ í†µí•´ ë¸Œë¼ìš°ì € íƒ­ì˜ ê°€ì‹œì„± ë³€ê²½ ì´ë²¤íŠ¸ë¥¼ ê°ì§€í•˜ì—¬ ê°€ì‹œì„± ìƒíƒœê°€ ë˜ë©´ `state`ë¥¼ ë™ê¸°í™”í•©ë‹ˆë‹¤. ì‚¬ìš© ì¼€ì´ìŠ¤ë¡œ `sessionStorage`ì™€ ë‹¤ë¥´ê²Œ íƒ­ ê°„ ê³µìœ ë˜ëŠ” ì €ì¥ì†Œì´ê¸° ë•Œë¬¸ì— íƒ­ ê°„ ë™ê¸°í™”ê°€ í•„ìš”í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.

```ts
const { state, setState } = useLocalStorage<number[]>({
  key: 'test',
  initialValue: [1, 2],
  visibilityChange: true,
});
```

<br />

## Code
[ğŸ”— ì‹¤ì œ êµ¬í˜„ ì½”ë“œ í™•ì¸](https://github.com/modern-agile-team/modern-kit/blob/main/packages/react/src/hooks/useLocalStorage/index.ts)

## Interface
```ts title="typescript"
interface UseLocalStorageWithoutInitialValueProps {
  key: string;
  visibilityChange?: boolean;
}

interface UseLocalStorageWithInitialValueProps<T> {
  key: string;
  initialValue: T | (() => T);
  visibilityChange?: boolean;
}

type UseLocalStorageProps<T> =
  | UseLocalStorageWithoutInitialValueProps
  | UseLocalStorageWithInitialValueProps<T>;
```
```ts
// í•¨ìˆ˜ ì˜¤ë²„ë¡œë”©
function useLocalStorage<T>({
  key,
  initialValue,
}: UseLocalStorageWithInitialValueProps<T>): {
  state: T;
  setState: Dispatch<SetStateAction<T>>;
  removeState: () => void;
};

function useLocalStorage<T = unknown>({
  key,
}: UseLocalStorageWithoutInitialValueProps): {
  state: T | null;
  setState: Dispatch<SetStateAction<T | null>>;
  removeState: () => void;
};
```

## Usage
```tsx title="typescript"
import { useLocalStorage } from '@modern-kit/react';

const Example = () => {
  const { state, setState, removeState } = useLocalStorage<string>({
    key: 'test',
    initialValue: 'default',
  });

  return (
    <div>
      <p>ê°œë°œì ë„êµ¬ì—ì„œ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!</p>
      <p>state: {state}</p>
      <button onClick={() => setState('foo')}>
        {`ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ "test"keyì— "foo"ë°ì´í„° ì €ì¥`}
      </button>
      <button onClick={() => setState('bar')}>
        {`ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ "test"keyì— "bar"ë°ì´í„° ì €ì¥`}
      </button>
      <button onClick={() => removeState()}>
        {`ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ "test"key ì œê±°`}
      </button>
    </div>
  );
};
```

## Example

export const Example = () => {
  const { state, setState, removeState } = useLocalStorage({
    key: 'test',
    initialValue: 'default',
  });

  return (
    <div>
      <p>ê°œë°œì ë„êµ¬ì—ì„œ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!</p>
      <p>state: {state}</p>
      <button onClick={() => setState('foo')}>
        {`ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ "test"keyì— "foo"ë°ì´í„° ì €ì¥`}
      </button>
      <button onClick={() => setState('bar')}>
        {`ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ "test"keyì— "bar"ë°ì´í„° ì €ì¥`}
      </button>
      <button onClick={() => removeState()}>
        {`ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ "test"key ì œê±°`}
      </button>
    </div>
  );
};


<Example />